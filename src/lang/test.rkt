;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Standard Library Tests
;;
;; 1. Internal functions
;; 2. Core functions
;; 3. List and pars
;; 4. Logic
;; 5. Math
;; 6. Test helpers
;; 7. Macros
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Internal functions
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Core functions
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(assert (boolean? #f))
(assert (boolean? #t))
(assert (builtin? eval))
(assert (error? (error 'ok)))
(assert (false? #f))
(assert (integer? 123))
(assert (lambda? (lambda () 'ok)))
(assert (list? '()))
(assert (list? '(1 2 3)))
(assert (list? (list 1 2 3)))
(assert (list? (list)))
(assert (null? '()))
(assert (pair? (cons 1 2)))
(assert (quote? 'ok))
(assert (real? 1.2))
(assert (string? "ok"))
(assert (true? #t))
(assert (zero? 0))

(assert-eq '(2 4 6 8) (map double '(1 2 3 4)))
(assert-eq 10 (fold 0 + '(1 2 3 4)))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; List and pars
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(assert-eq '(1 2 3) (list 1 2 3))
(assert-eq '(1 2 3) (list (+ 1) (+ 1 1) (+ 1 1 1)))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Logic
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(assert-eq #t (or #f #f #t invalid invalid invalid))
(assert-eq #t (or 1 2 3 4))
(assert-eq #f (and #f #f #t))
(assert-eq #t (and #t #t #t))
(assert-eq #t (and 1 2 3 4))
(assert-eq #t (not #f))
(assert-eq #f (not #t))
(assert-eq #f (not '()))
(assert-eq #f (not 0))
(assert-eq #f (not ""))
(assert-eq #f (not 'ok))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Math
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(assert-eq 4 (double 2))
(assert-eq 16 (double 8))
(assert-eq 9 (triple 3))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Test helpers
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(assert (ok? 'ok))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Macros
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(assert-eq 24
  (-> 2
      (double)
      (double)
      (triple)))
